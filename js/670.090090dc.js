"use strict";(self["webpackChunkedomaeZushi"]=self["webpackChunkedomaeZushi"]||[]).push([[670],{4439:function(e,t,a){a.d(t,{Z:function(){return _}});var o=a(3396),l=a(7139),s=a(9242);const i={class:"py-5","aria-label":"Page navigation"},n={class:"pagination justify-content-center"},d=(0,o._)("span",{"aria-hidden":"true"},[(0,o._)("i",{class:"bi bi-arrow-left-short"})],-1),c=[d],r=["onClick"],p=(0,o._)("span",{"aria-hidden":"true"},[(0,o._)("i",{class:"bi bi-arrow-right-short"})],-1),u=[p];function h(e,t,a,d,p,h){return(0,o.wg)(),(0,o.iD)("nav",i,[(0,o._)("ul",n,[(0,o._)("li",{class:(0,l.C_)(["page-item",{disabled:1===a.pages.current_page}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,s.iM)((e=>h.emitPage(a.pages.current_page-1)),["prevent"]))},c)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.pages.total_pages,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{class:(0,l.C_)(["page-item",{active:e===a.pages.current_page}]),key:t},[(0,o._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((t=>h.emitPage(e)),["prevent"])},(0,l.zw)(e),9,r)],2)))),128)),(0,o._)("li",{class:(0,l.C_)(["page-item",{disabled:a.pages.current_page===a.pages.total_pages}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,s.iM)((e=>h.emitPage(a.pages.current_page+1)),["prevent"]))},u)],2)])])}var m={props:["pages"],methods:{emitPage(e){this.$emit("emit-page",e)}}},g=a(89);const b=(0,g.Z)(m,[["render",h]]);var _=b},2316:function(e,t,a){a.d(t,{Z:function(){return M},_:function(){return k}});var o=a(3396),l=a(7139);const s={class:"modal fade",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true",ref:"delModal"},i={class:"modal-dialog modal-dialog-centered"},n={class:"modal-content"},d={class:"modal-header"},c={class:"modal-title",id:"delModalLabel"},r=(0,o._)("i",{class:"bi bi-exclamation-triangle-fill text-danger me-2"},null,-1),p={key:0,class:"text-danger mx-1"},u={key:1,class:"text-danger mx-1"},h=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),m=(0,o._)("div",{class:"modal-body"},"刪除之後資料不可逆，不可反悔喔！",-1),g={class:"modal-footer"},b=(0,o._)("button",{type:"button",class:"btn btn-link text-decoration-none text-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),_=["disabled"],w={key:0,class:"spinner-border spinner-border-sm align-middle me-1",role:"status"},f=(0,o._)("span",{class:"visually-hidden"},"Loading...",-1),v=[f],C={key:1,class:"bi bi-trash-fill me-1"};function y(e,t,a,f,y,k){return(0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("div",i,[(0,o._)("div",n,[(0,o._)("div",d,[(0,o._)("h5",c,[r,(0,o.Uk)(" 熊孩子，您確定要刪除 "),a.delItem.title?((0,o.wg)(),(0,o.iD)("span",p,(0,l.zw)(a.delItem.title),1)):((0,o.wg)(),(0,o.iD)("span",u,(0,l.zw)(a.delItem.id),1)),(0,o.Uk)(" 嗎？ ")]),h]),m,(0,o._)("div",g,[b,(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=e=>k.delProdBtn(a.delItem.id)),disabled:y.isLoading===a.delItem.id},[y.isLoading===a.delItem.id?((0,o.wg)(),(0,o.iD)("div",w,v)):((0,o.wg)(),(0,o.iD)("i",C)),(0,o.Uk)("確定刪除 ")],8,_)])])])],512)}let k=null;var x={data(){return{isLoading:""}},props:["delItem","pageName"],methods:{delProdBtn(e){this.isLoading=e;let t="";"prodsList"===this.pageName?t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/product/${e}`:"orders"===this.pageName?t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/order/${e}`:"coupons"===this.pageName&&(t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon/${e}`),this.$http.delete(t).then((e=>{this.isLoading="",this.$emit("get-item"),k.hide(),setTimeout((()=>{alert(e.data.message)}),1e3)})).catch((e=>{this.isLoading="",k.hide(),alert(e.response.data.message)}))}},mounted(){k=new bootstrap.Modal(this.$refs.delModal,{keyboard:!1})}},D=a(89);const N=(0,D.Z)(x,[["render",y]]);var M=N},1670:function(e,t,a){a.r(t),a.d(t,{default:function(){return De}});var o=a(3396),l=a(9242),s=a(7139);const i={class:"container"},n={class:"text-center my-3"},d=(0,o._)("div",{class:"mb-3"},[(0,o._)("h2",null,"折扣碼列表")],-1),c=(0,o._)("i",{class:"bi bi-pencil-square me-1"},null,-1),r=(0,o._)("span",null,"新增折扣碼",-1),p=[c,r],u={key:0},h=(0,o._)("div",{class:"text-center"},[(0,o._)("p",null,"尚無建立折扣碼，您的鐵粉在哭哭！")],-1),m=[h],g={key:1},b={class:"row my-4 mb-lg-5"},_={class:"col-lg-4 col-xl-3 offset-lg-8 offset-xl-9"},w={class:"search"},f={class:"input-group"},v=(0,o._)("span",{class:"input-group-text",id:"search"},[(0,o._)("i",{class:"bi bi-search text-secondary"})],-1),C=(0,o.uE)('<div class="row g-3 mx-1 d-none d-lg-flex pb-2 border-bottom border-2 border-dark"><div class="col-lg-3"><h3 class="h6 fw-bold">折扣碼</h3></div><div class="col-lg-2"><h3 class="h6 fw-bold">折扣數</h3></div><div class="col-lg-3"><h3 class="h6 fw-bold">到期日</h3></div><div class="col-lg-2"><h3 class="h6 fw-bold">是否啟用</h3></div><div class="col-lg-2"><h3 class="h6 fw-bold">編輯／刪除</h3></div></div>',1),y={class:"col-lg-3"},k={class:""},x=(0,o._)("h3",{class:"h6 fw-bold d-lg-none"},"折扣碼",-1),D={class:"mt-4 mt-lg-0"},N=(0,o._)("h3",{class:"h6 fw-bold d-lg-none"},"折扣標題",-1),M=(0,o._)("b",{class:"d-none d-lg-inline"},"標題：",-1),$={class:"col-lg-2"},I=(0,o._)("h3",{class:"h6 fw-bold d-lg-none"},"折扣數",-1),T={class:"col-lg-3"},U=(0,o._)("h3",{class:"h6 fw-bold d-lg-none"},"到期日",-1),P={class:"col-lg-2"},L=(0,o._)("h3",{class:"h6 fw-bold d-lg-none"},"是否啟用",-1),Z={class:"form-check form-switch"},z=["id","onUpdate:modelValue","onChange"],V=["for"],S={key:0,class:"text-light-green fw-bold"},B={key:1,class:"text-danger"},E={class:"col-lg-2"},O=(0,o._)("h3",{class:"h6 fw-bold d-lg-none"},"編輯／刪除",-1),W={class:"btn-group",role:"group"},A=["onClick"],G=(0,o._)("i",{class:"bi bi-pencil-fill"},null,-1),H=[G],J=["onClick"],K=(0,o._)("i",{class:"bi bi-trash-fill"},null,-1),Y=[K];function j(e,t,a,c,r,h){const G=(0,o.up)("PageComp"),K=(0,o.up)("CreateCouponComp"),j=(0,o.up)("DelAdminComp");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",n,[d,(0,o._)("button",{type:"button",class:"btn btn-dark",onClick:t[0]||(t[0]=e=>h.openModal("new"))},p)]),0===r.coupons.length?((0,o.wg)(),(0,o.iD)("div",u,m)):((0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("div",b,[(0,o._)("div",_,[(0,o._)("div",w,[(0,o._)("div",f,[v,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",placeholder:"搜尋折扣碼","aria-label":"search","aria-describedby":"search","onUpdate:modelValue":t[1]||(t[1]=e=>r.searchItem=e)},null,512),[[l.nr,r.searchItem,void 0,{trim:!0}]])])])])]),C,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.copyCoupons,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"row g-3 mx-1 my-3 border-bottom py-3 py-lg-0 customer-card",key:e.id},[(0,o._)("div",y,[(0,o._)("div",k,[x,(0,o._)("p",{class:(0,s.C_)(["border border-dashed fw-bold p-2",[{"border-light-green":(new Date).getTime()<=new Date(1e3*e.due_date).getTime(),"text-light-green":(new Date).getTime()<=new Date(1e3*e.due_date).getTime(),"border-danger":(new Date).getTime()>new Date(1e3*e.due_date).getTime(),"text-danger":(new Date).getTime()>new Date(1e3*e.due_date).getTime()}]]),style:{width:"fit-content"}},(0,s.zw)(e.code),3)]),(0,o._)("div",D,[N,(0,o._)("p",null,[M,(0,o.Uk)(" "+(0,s.zw)(e.title),1)])])]),(0,o._)("div",$,[I,(0,o._)("p",null,"打 "+(0,s.zw)(e.percent/10)+" 折",1)]),(0,o._)("div",T,[U,(0,o._)("p",null,(0,s.zw)(new Date(1e3*e.due_date).toLocaleDateString()),1)]),(0,o._)("div",P,[L,(0,o._)("div",Z,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:e.id,"onUpdate:modelValue":t=>e.is_enabled=t,"true-value":1,"false-value":0,onChange:t=>h.updateEnabled(e)},null,40,z),[[l.e8,e.is_enabled]]),(0,o._)("label",{class:"form-check-label cursor-pointer mb-3",for:e.id},[e.is_enabled?((0,o.wg)(),(0,o.iD)("span",S," 啟用 ")):((0,o.wg)(),(0,o.iD)("span",B,"未啟用"))],8,V)])]),(0,o._)("div",E,[O,(0,o._)("div",W,[(0,o._)("button",{type:"button",class:"btn btn-outline-light-green",onClick:t=>h.openModal("edit",e)},H,8,A),(0,o._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>h.openModal("delete",e)},Y,8,J)])])])))),128)),(0,o.Wm)(G,{pages:r.pagination,onEmitPage:h.getCoupons},null,8,["pages","onEmitPage"])])),(0,o.Wm)(K,{coupon:r.tempCoupon,"is-new":r.isNew,onUpdateCoupons:h.getCoupons},null,8,["coupon","is-new","onUpdateCoupons"]),(0,o.Wm)(j,{"del-item":r.tempCoupon,"page-name":r.pageName,onGetItem:h.getCoupons},null,8,["del-item","page-name","onGetItem"])])}a(7658);var q=a(4439);const F={class:"modal fade",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true",ref:"couponModal"},Q={class:"modal-dialog modal-dialog-centered"},R={class:"modal-content"},X={class:"modal-header"},ee={class:"modal-title",id:"couponModalLabel"},te=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ae={class:"modal-body"},oe={class:"form-floating mb-3"},le=(0,o._)("label",{for:"floatingTitle"},"標題",-1),se={class:"form-floating mb-3"},ie=(0,o._)("label",{for:"floatingCode"},"折扣碼",-1),ne={class:"form-floating mb-3"},de=(0,o._)("label",{for:"floatingDate"},"到期日 (點選 icon)",-1),ce={class:"form-floating mb-3"},re=(0,o._)("label",{for:"floatingPrice"},"折扣率（打八折請輸入80）",-1),pe={class:"mb-3 ms-2"},ue={class:"form-check"},he=(0,o._)("label",{class:"form-check-label",for:"is_enabled"}," 啟用 ",-1),me={class:"modal-footer"},ge=(0,o._)("button",{type:"button",class:"btn btn-link text-decoration-none text-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function be(e,t,a,i,n,d){return(0,o.wg)(),(0,o.iD)("div",F,[(0,o._)("div",Q,[(0,o._)("div",R,[(0,o._)("div",X,[(0,o._)("h5",ee,(0,s.zw)(a.isNew?"新增優惠券":"編輯優惠券"),1),te]),(0,o._)("div",ae,[(0,o._)("div",oe,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control border-0 border-bottom rounded-0",id:"floatingTitle",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=e=>n.tempCoupon.title=e)},null,512),[[l.nr,n.tempCoupon.title]]),le]),(0,o._)("div",se,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control border-0 border-bottom rounded-0",id:"floatingCode",placeholder:"請輸入折扣碼","onUpdate:modelValue":t[1]||(t[1]=e=>n.tempCoupon.code=e)},null,512),[[l.nr,n.tempCoupon.code]]),ie]),(0,o._)("div",ne,[(0,o.wy)((0,o._)("input",{type:"date",class:"form-control border-0 border-bottom rounded-0",id:"floatingDate","onUpdate:modelValue":t[2]||(t[2]=e=>n.due_date=e)},null,512),[[l.nr,n.due_date]]),de]),(0,o._)("div",ce,[(0,o.wy)((0,o._)("input",{type:"number",class:"form-control border-0 border-bottom rounded-0",id:"floatingPrice",min:"0",max:"100",oninput:"if(value>100)value=100",placeholder:"請輸入打折數","onUpdate:modelValue":t[3]||(t[3]=e=>n.tempCoupon.percent=e)},null,512),[[l.nr,n.tempCoupon.percent,void 0,{number:!0}]]),re]),(0,o._)("div",pe,[(0,o._)("div",ue,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>n.tempCoupon.is_enabled=e),"true-value":1,"false-value":0},null,512),[[l.e8,n.tempCoupon.is_enabled]]),he])])]),(0,o._)("div",me,[ge,(0,o._)("button",{type:"button",class:(0,s.C_)(["btn",[{"btn-dark":a.isNew},{"btn-light-green":!a.isNew}]]),onClick:t[5]||(t[5]=(...e)=>d.updateCouponBtn&&d.updateCouponBtn(...e))},[(0,o._)("i",{class:(0,s.C_)(["bi me-2",[{"bi-check-lg":a.isNew},{"bi-check-all":!a.isNew}]])},null,2),(0,o.Uk)((0,s.zw)(a.isNew?"確定新增":"確定修改"),1)],2)])])])],512)}let _e=null;var we={data(){return{tempCoupon:{},due_date:""}},props:["coupon","isNew"],watch:{coupon(){this.tempCoupon=this.coupon,[this.due_date]=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T")},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{updateCouponBtn(){let e=this.$loading.show(),t="https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon",a="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon/${this.coupon.id}`,a="put"),this.$http[a](t,{data:this.coupon}).then((t=>{e.hide(),this.$emit("update-coupons"),_e.hide(),setTimeout((()=>{alert(t.data.message)}),1e3)})).catch((t=>{e.hide(),console.dir(t.response),alert(t.response.data.message)}))}},mounted(){_e=new bootstrap.Modal(this.$refs.couponModal,{keyboard:!1})}},fe=a(89);const ve=(0,fe.Z)(we,[["render",be]]);var Ce=ve,ye=a(2316),ke={data(){return{coupons:{},copyCoupons:{},tempCoupon:{is_enabled:0},pageName:"coupons",pagination:{},isNew:!0,searchItem:""}},watch:{searchItem(){this.filterSearch()}},components:{PageComp:q.Z,CreateCouponComp:Ce,DelAdminComp:ye.Z},methods:{getCoupons(e=1){let t=this.$loading.show();this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupons?page=${e}`).then((e=>{t.hide(),this.coupons=e.data.coupons,this.copyCoupons=this.coupons,this.pagination=e.data.pagination})).catch((e=>{console.dir(e.response),t.hide()}))},updateEnabled(e){let t=this.$loading.show();this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon/${e.id}`,{data:e}).then((e=>{t.hide(),setTimeout((()=>{alert(e.data.message)}),600)})).catch((e=>{t.hide(),alert(e.response.data.message)}))},openModal(e,t){"new"===e?(this.tempCoupon={due_date:(new Date).getTime()/1e3},this.isNew=!0,_e.show()):"edit"===e?(this.tempCoupon={...t},this.isNew=!1,_e.show()):"delete"===e&&(this.tempCoupon={...t},this.isNew=!1,ye._.show())},filterSearch(){const e=JSON.parse(JSON.stringify(this.coupons)),t=[];e.filter((e=>{e.code.includes(this.searchItem)?t.push(e):""===this.searchItem&&t.push(this.coupons)})),this.copyCoupons=t}},mounted(){this.getCoupons()}};const xe=(0,fe.Z)(ke,[["render",j]]);var De=xe}}]);
//# sourceMappingURL=670.090090dc.js.map